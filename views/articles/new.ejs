<% layout('./layouts/boilerplate') %>

    <div class="new-article-container">
        <form action="/articles/new" method="post" enctype="multipart/form-data">
            <!-- Header -->
            <h1 class="story">Tell Your Story</h1>

            <!-- Title -->
            <div class="form-group animate">
                <label for="title">
                    Title <span class="required-asterisk" aria-hidden="true">*</span>
                </label>
                <input type="text" id="title" name="title" class="txtfield"
                    placeholder="Enter your captivating article title..." required maxlength="100">
            </div>

            <!-- Image Upload -->
            <div class="form-group animate">
                <label for="image">Featured Image <span class="required-asterisk" aria-hidden="true">*</span></label>
                <div class="file-input-wrapper">
                    <input type="file" id="image" name="image" accept="image/*" class="file-input" required>
                    <label for="image" class="file-input-label">
                        <div>
                            <svg class="file-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
                            </svg>
                            <span class="file-text">Click to browse</span>
                            <span class="file-subtext">Supports JPG, PNG, GIF up to 10MB</span>
                        </div>
                    </label>
                    <div id="image-preview" class="image-preview"></div>
                </div>
            </div>

            <!-- Description/Content -->
            <div class="form-group animate">
                <label for="description">
                    Article Content <span class="required-asterisk" aria-hidden="true">*</span>
                </label>
                <textarea id="description" name="description" class="txtfield" rows="12"
                    placeholder="Share your thoughts, stories, and insights with the world..." required></textarea>
            </div>

            <!-- Submit Button -->
            <div class="form-group publish">
                <button type="submit" class="btn-primary">
                    Publish Article
                </button>
            </div>
        </form>
    </div>

    <script>
        // Simple form interactions
        document.addEventListener('DOMContentLoaded', function () {
            const inputs = document.querySelectorAll('input, textarea');
            const form = document.querySelector('form');
            const imageInput = document.getElementById('image');
            const imagePreview = document.getElementById('image-preview');

            // Animate form groups on load
            const formGroups = document.querySelectorAll('.form-group');
            formGroups.forEach((group, index) => {
                setTimeout(() => {
                    group.style.opacity = '1';
                    group.style.transform = 'translateY(0)';
                }, index * 100);
            });

            // Enhanced input interactions
            inputs.forEach(input => {
                input.addEventListener('focus', function () {
                    this.parentElement.classList.add('focused');
                    if (this.classList.contains('txtfield')) {
                        this.style.transform = 'translateY(-2px)';
                    }
                });

                input.addEventListener('blur', function () {
                    this.parentElement.classList.remove('focused');
                    if (this.classList.contains('txtfield')) {
                        this.style.transform = 'translateY(0)';
                    }
                });
            });

            // Image preview functionality
            imageInput.addEventListener('change', function (e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function (e) {
                        imagePreview.innerHTML = `
                        <div class="preview-container">
                            <img src="${e.target.result}" alt="Preview" class="preview-image">
                            <button type="button" class="remove-image" onclick="removeImage()">Ã—</button>
                        </div>
                    `;
                    };
                    reader.readAsDataURL(file);
                }
            });

            // Form validation
            form.addEventListener('submit', function (e) {
                const title = document.getElementById('title').value.trim();
                const description = document.getElementById('description').value.trim();

                if (title.length < 3) {
                    e.preventDefault();
                    alert('Title must be at least 3 characters long');
                    document.getElementById('title').focus();
                    return;
                }

                if (description.length < 50) {
                    e.preventDefault();
                    alert('Article content must be at least 50 characters long');
                    document.getElementById('description').focus();
                    return;
                }
            });
        });

        // Function to remove image preview
        function removeImage() {
            document.getElementById('image').value = '';
            document.getElementById('image-preview').innerHTML = '';
        }
    </script>